<div class="mt-4">
    <div class="container">
        <div class="row">
            <div class="col-lg-3">
                <button>Xem ngay</button>
            </div>
            <div class="col-lg-9">
                <h2> {{course.name}}</h2>
                <iframe width="560" height="315" src="https://www.youtube.com/embed/{{course.videoid}}"
                    title="YouTube video player" frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    referrerpolicy="strict-origin-when-cross-origin" allowfullscreen></iframe>
                <p>{{{course.description}}}</p>
                <p class="duration"></p>
            </div>


        </div>
    </div>

</div>
<script>
    const videoId = '{{course.videoid}}'; // Lấy videoid từ course
    const dura = document.querySelector('.duration')

    const fetchVideoDuration = async () => {
        try {
            const response = await fetch(`https://www.googleapis.com/youtube/v3/videos?id=${videoId}&part=contentDetails&key=AIzaSyCpJVWwohJjYhQuS7XNymqAHf1LNIGxpmU`, {
                method: 'GET',
                headers: {
                    'Content-Type': 'application/json',
                }
            });

            // Kiểm tra xem yêu cầu có thành công không
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }

            const data = await response.json();
            console.log(data); // Xem toàn bộ dữ liệu trả về

            // Lấy duration từ dữ liệu
            const duration = data.items[0]?.contentDetails?.duration;
            console.log('Video Duration:', duration); // Hiển thị duration
            // Hiển thị duration ở thanh địa chỉ

            // Chuyển đổi duration từ định dạng ISO 8601
            const parsedDuration = parseDuration(duration);
            console.log('Parsed Duration:', parsedDuration);
            dura.textContent = `Thời lượng phim: ${parsedDuration}`;

        } catch (error) {
            console.error('There has been a problem with your fetch operation:', error);
        }
    };

    // Hàm để chuyển đổi định dạng duration
    const parseDuration = (duration) => {

        const regex = /PT(?:(\d+)H)?(?:(\d+)M)?(?:(\d+)S)?/;
        const matches = regex.exec(duration);
        const hours = matches[1] ? parseInt(matches[1]) : 0;
        const minutes = matches[2] ? parseInt(matches[2]) : 0;
        const seconds = matches[3] ? parseInt(matches[3]) : 0;

        return `${hours}:${minutes}:${seconds}`;
    };

    fetchVideoDuration(); // Gọi hàm để lấy duration


</script>